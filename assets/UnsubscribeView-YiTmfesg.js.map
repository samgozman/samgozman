{"version":3,"file":"UnsubscribeView-YiTmfesg.js","sources":["../../src/views/subscriptions/UnsubscribeView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { onMounted, ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport ArticleProse from '@/components/elements/ArticleProse.vue'\nimport { BloggyApi } from '@/services/BloggyApi'\n\nwindow.document.title = 'Unsubscribe  | Sam Gozman'\n\nconst error = ref('Confirm unsubscribing')\nconst unsubscribeToken = ref('')\nconst unsubscribeReason = ref('')\nconst router = useRouter()\n\nonMounted(async () => {\n  // Get `token` from url query param\n  const url = new URL(window.location.href)\n  const token = url.searchParams.get('token')\n  if (!token) {\n    error.value = 'Invalid token'\n    return\n  }\n\n  unsubscribeToken.value = token\n})\n\nconst onSubmit = async (event: Event) => {\n  event.preventDefault()\n\n  try {\n    const res = await BloggyApi.unsubscribe(unsubscribeToken.value, unsubscribeReason.value)\n    if (!res.ok) {\n      return\n    }\n\n    error.value = ''\n\n    setTimeout(() => {\n      router.push({ name: 'home' })\n    }, 5000)\n  } catch (err) {\n    error.value = 'Failed to unsubscribe'\n    console.error(err)\n  }\n}\n</script>\n\n<template>\n  <ArticleProse>\n    <h2>Unsubscribe fom blog:</h2>\n\n    <form @submit=\"onSubmit\">\n      <p v-if=\"error\" class=\"text-error\">{{ error }}</p>\n      <p v-else>You have successfully unsubscribed from my blog! ðŸ˜¢</p>\n      <div class=\"flex flex-col max-w-80\">\n        <textarea\n          class=\"textarea textarea-bordered\"\n          placeholder=\"Reason for unsubscribing\"\n          :value=\"unsubscribeReason\"\n        ></textarea>\n        <button class=\"btn btn-primary mt-2\">Unsubscribe</button>\n      </div>\n    </form>\n  </ArticleProse>\n</template>\n"],"names":["error","ref","unsubscribeToken","unsubscribeReason","router","useRouter","onMounted","token","onSubmit","event","BloggyApi","err"],"mappings":"2VAMA,OAAO,SAAS,MAAQ,4BAElB,MAAAA,EAAQC,EAAI,uBAAuB,EACnCC,EAAmBD,EAAI,EAAE,EACzBE,EAAoBF,EAAI,EAAE,EAC1BG,EAASC,IAEfC,EAAU,SAAY,CAGpB,MAAMC,EADM,IAAI,IAAI,OAAO,SAAS,IAAI,EACtB,aAAa,IAAI,OAAO,EAC1C,GAAI,CAACA,EAAO,CACVP,EAAM,MAAQ,gBACd,MACF,CAEAE,EAAiB,MAAQK,CAAA,CAC1B,EAEK,MAAAC,EAAW,MAAOC,GAAiB,CACvCA,EAAM,eAAe,EAEjB,GAAA,CAEE,GAAA,EADQ,MAAMC,EAAU,YAAYR,EAAiB,MAAOC,EAAkB,KAAK,GAC9E,GACP,OAGFH,EAAM,MAAQ,GAEd,WAAW,IAAM,CACfI,EAAO,KAAK,CAAE,KAAM,MAAQ,CAAA,GAC3B,GAAI,QACAO,EAAK,CACZX,EAAM,MAAQ,wBACd,QAAQ,MAAMW,CAAG,CACnB,CAAA"}